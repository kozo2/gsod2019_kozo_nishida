---
title: "WikiPathways App"
author: "Kozo Nishida, Kristina Hanspers and Alex Pico"
date: "`r Sys.Date()`"
output:
  BiocStyle::html_document:
    toc: true
    toc_depth: 4
    df_print: paged
---
```{r, echo = FALSE}
knitr::opts_chunk$set(
  eval=FALSE
)
```

# Installation
```{r, eval = FALSE}
if (!requireNamespace("BiocManager", quietly = TRUE))
  install.packages("BiocManager")

if(!"RCy3" %in% installed.packages())
  BiocManager::install("RCy3")

library(RCy3)
```

## Prerequisites
In addition to the RCy3 package, you will need the latest version of Cytoscape, which can be downloaded from http://www.cytoscape.org/download.php. Simply follow the installation instructions on screen.

## Getting started
First, launch Cytoscape and keep it running whenever using RCy3. Confirm that you have everything installed and running:
```{r}
    cytoscapePing()
    cytoscapeVersionInfo()
```

# WikiPathways App

[WikiPathways](https://www.wikipathways.org/) is a database of biological pathways maintained by and for the scientific community. Each pathway model in the database is annotated with database identfiers, which can be used for computation and data visualization. The WikiPathways App for Cytoscape is available from the [App Store](http://apps.cytoscape.org/apps/wikipathways).


This tutorial includes a basic workflow for visualizing experimental data on pathways in Cytoscape, as well as how to import pathways as networks.

## Setup

- Install the WikiPathways app via

```{r}
installApp('WikiPathways')
```

- Install the rWikiPathways package via

```{r}
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")

BiocManager::install("rWikiPathways")
library(rWikiPathways)
```

- Import the [experimental data](https://cytoscape.github.io/cytoscape-tutorials/protocols/data/WPExpData.csv) via

```{r}
data <- read.csv("https://cytoscape.github.io/cytoscape-tutorials/protocols/data/WPExpData.csv")
```

The data has been modified from [Expression Atlas](https://www.ebi.ac.uk/gxa/experiments/E-GEOD-6088/Downloads), and compares gene expression between individuals with homozygous familial hypercholesterolemia and normal individuals (log2 fold change values).

## Importing Pathways

You can search for pathways based on a keyword *Statin* via

```{r}
statin.pathways <- findPathwaysByText('Statin')
```

We have a list of pathways that mention *Statin*.
The results include lots of information, so let’s select human one and get a unique list of just the WPIDs.

```{r}
human.statin.filter <- lapply(statin.pathways, function(x) {x$species == "Homo sapiens" && x$name == "Statin Pathway"})
human.statin.pathways <- statin.pathways[unlist(human.statin.filter)]
human.statin.wpids <- unique(unlist(lapply(human.statin.pathways, function(x) x$id)))
```

Let’s import the first one of these into Cytoscape!

```{r}
commandsRun(paste0('wikipathways import-as-pathway id=',human.statin.wpids[1]))
```

The pathway opens in Cytoscape with the original pathway layout and the WikiPathways style:



