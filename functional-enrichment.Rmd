---
title: "Functional Enrichment Analysis"
author: "Kozo Nishida, Kristina Hanspers and Alex Pico"
date: "`r Sys.Date()`"
output:
  BiocStyle::html_document:
    toc: true
    toc_depth: 4
    df_print: paged
---
```{r, echo = FALSE}
knitr::opts_chunk$set(
  eval=FALSE
)
```

*The R markdown is available from the pulldown menu for* Code *at the upper-right, choose "Download Rmd", or [download the Rmd from GitHub](https://raw.githubusercontent.com/nrnb/gsod2019_kozo_nishida/master/functional-enrichment.Rmd).*

<hr />

This tutorial will take you through a functional enrichment workflow in Cytoscape. Key aspects covered in this tutorial are:

- Retrieve Networks and Pathways
- Integrate and Explore Your Data
- Perform Functional Enrichment Analysis
- Functional Interpretation and Display

<hr />

# Installation
```{r, eval = FALSE}
if (!requireNamespace("BiocManager", quietly = TRUE))
  install.packages("BiocManager")

if(!"RCy3" %in% installed.packages())
  BiocManager::install("RCy3")

library(RCy3)
```

# Getting started
First, launch Cytoscape and keep it running whenever using RCy3. Confirm that you have everything installed and running:
```{r}
    cytoscapePing()
    cytoscapeVersionInfo()
```

# Setup

Install the [Functional Enrichment Collection](http://apps.cytoscape.org/apps/functionalenrichmentcollection).
(This installation takes time to complete. You can check the installation progress in the status bar of the Cytoscape desktop.)

```{r}
installApp('Functional Enrichment Collection')
```

And install the other R packages for this tutorial

```{r}
install.packages("dplyr")
```


# Load TCGA data

**Create the network (with no edges) with the data.**

- Read [GBM-TP.all.tsv](https://cytoscape.github.io/cytoscape-tutorials/protocols/data/GBM-TP-all.tsv).

```{r}
df <- read.table("https://cytoscape.github.io/cytoscape-tutorials/protocols/data/GBM-TP-all.tsv", sep = '\t', header = TRUE)
```

- Import the file to create a network. We set **GeneName** column as the **node ID** column.

```{r}
library(dplyr)
df %>% mutate(id = GeneName) -> df4createnet
```

The following code takes time to complete because the `df4createnet` is large (there are many columns).

```{r}
createNetworkFromDataFrames(df4createnet)
```

  - You’ll see no edges, but that’s OK. This will create a grid of 1500 unconnected nodes, where each node represents a gene.
